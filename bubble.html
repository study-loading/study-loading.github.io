<!doctype html>
<html>
	<head>
		<style>
			body{
				background-color:#ccc;
			}
			.bubble{
				float:left;
				width:150px;
				height:150px;
				border-radius:100%;
				box-shadow:20px 20px 15px #eee inset;
			}
		</style>
	</head>
	<body>
		<section>
			<div class="bubble" style="background-color:#f00"></div>
			<div class="bubble" style="background-color:#f0f"></div>
			<div class="bubble" style="background-color:#00f"></div>
			<div class="bubble" style="background-color:#0ff"></div>
			<div class="bubble" style="background-color:#0f0"></div>
			<div class="bubble" style="background-color:#ff0"></div>
		</section>
		<script>
			//面向过程编程
			(function(){
				var bubble = document.getElementsByClassName("bubble");
				var list = [
					{r:255, g:0, b:0},
					{r:255, g:0, b:255},
					{r:0, g:0, b:255},
					{r:0, g:255, b:255},
					{r:0, g:255, b:0},
					{r:255, g:255, b:0}
				];
				var data = new Array(bubble.length);
				for(var i=0; i<data.length; i++){
					data[i] = {
						r: list[i].r,
						g: list[i].g,
						b: list[i].b,
						dir: [['r','b'],['b','g'],['g','r']]
					};
					data[i].status = parseInt(i/2) % 3;
				}

				var timer = setInterval(function(){
					//console.log(data[0].r + ": " + data[0].g + ": " + data[0].b);
					for(var i=0; i<bubble.length; i++){
						changeColor(i);
						bubble[i].style.backgroundColor = "rgb(" + data[i].r + "," + data[i].g + "," + data[i].b + ")";
					}
				},200);

				function changeColor(index){
					var status = data[index].status,
						x = data[index].dir[status][0],
						y = data[index].dir[status][1],
						origin = data[index][x],
						target = data[index][y];

					if(origin < 255 && target != 255){
						origin = (origin + 6 > 255)? 255 : origin + 6;
						data[index][x] = origin;
					}else{
						if(origin == 255 && target < 255){
							target = (target + 6 > 255)? 255 : target + 6;
							data[index][y] = target;
						}else{
							if(target == 255){
								if(origin == 0){
									data[index].status = (status + 1) % data[index].dir.length;
								}else{
									origin = (origin - 6 < 0)? 0 : origin - 6;
									data[index][x] = origin;
								}
							}
						}
					}
				}
			})();
		</script>
	</body>
</html>